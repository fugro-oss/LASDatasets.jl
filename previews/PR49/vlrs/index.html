<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Variable Length Records · LASDatasets.jl</title><meta name="title" content="Variable Length Records · LASDatasets.jl"/><meta property="og:title" content="Variable Length Records · LASDatasets.jl"/><meta property="twitter:title" content="Variable Length Records · LASDatasets.jl"/><meta name="description" content="Documentation for LASDatasets.jl."/><meta property="og:description" content="Documentation for LASDatasets.jl."/><meta property="twitter:description" content="Documentation for LASDatasets.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">LASDatasets.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../interface/">Interface</a></li><li><a class="tocitem" href="../header/">Header</a></li><li><a class="tocitem" href="../points/">Points</a></li><li class="is-active"><a class="tocitem" href>Variable Length Records</a><ul class="internal"><li><a class="tocitem" href="#Coordinate-Reference-System-VLRs"><span>Coordinate Reference System VLRs</span></a></li><li><a class="tocitem" href="#Other-Specification-Defined-VLRs"><span>Other Specification-Defined VLRs</span></a></li><li><a class="tocitem" href="#Custom-VLRs"><span>Custom VLRs</span></a></li></ul></li><li><a class="tocitem" href="../user_fields/">User Fields</a></li><li><a class="tocitem" href="../internals/">Internals</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Variable Length Records</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Variable Length Records</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/fugro-oss/LASDatasets.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/fugro-oss/LASDatasets.jl/blob/main/docs/src/vlrs.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Variable-Length-Records"><a class="docs-heading-anchor" href="#Variable-Length-Records">Variable Length Records</a><a id="Variable-Length-Records-1"></a><a class="docs-heading-anchor-permalink" href="#Variable-Length-Records" title="Permalink"></a></h1><p><em>Variable Length Records</em> are useful packets of data that one can include between the header block and start of the point records in a <em>LAS</em> file. The <em>LAS</em> 1.4 spec also allows for larger data payloads to be stored as <em>Extended Variable Length Records</em>, which are stored at the end of the file after the point records. The difference between these is that regular <em>VLRs</em> can only have a payload up to 2^16 bytes whereas <em>EVLRs</em> can have a payload up to 2^64.</p><p>All types of <em>VLRs</em> (regular and extended) are wrapped inside a <code>LasVariableLengthRecord</code> struct, which holds the data payload as well as the relevant <em>VLR</em> IDs and metadata. Each <code>LasVariableLengthRecord</code> is parametrised by the type of data in its payload which makes <em>LASDatasets.jl</em> able to handle parsing each <em>VLR</em> to/from a native <em>Julia</em> struct automatically.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LASDatasets.LasVariableLengthRecord-vlrs" href="#LASDatasets.LasVariableLengthRecord-vlrs"><code>LASDatasets.LasVariableLengthRecord</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct LasVariableLengthRecord{TData}</code></pre><p>A variable length record included in a LAS file. This stores a particular data type <code>TData</code> in the record, which can be a known VLR such as a WKT transform or a custom struct. To properly define I/O methods for VLR&#39;s of custom structs, you must register which user and record ID&#39;s this struct type  will use using </p><pre><code class="language-julia hljs">@register_vlr_type TData user_id record_ids</code></pre><p>And overload the methods <code>read_vlr_data</code> and <code>write_vlr_data</code> for your type <code>TData</code></p><p>See the LAS v1.4 spec <a href="https://www.asprs.org/wp-content/uploads/2019/03/LAS_1_4_r14.pdf#subsection.0.2.5">here</a> for more details.</p><ul><li><p><code>reserved::UInt16</code></p></li><li><p><code>user_id::String</code></p></li><li><p><code>record_id::UInt16</code>: Numerical ID assigned to this record type</p></li><li><p><code>description::String</code></p></li><li><p><code>data::Any</code></p></li><li><p><code>extended::Bool</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fugro-oss/LASDatasets.jl/blob/1328449f16cabfbb2c715365f439f5cc41632160/src/vlrs.jl#L1-L18">source</a></section></article><h2 id="Coordinate-Reference-System-VLRs"><a class="docs-heading-anchor" href="#Coordinate-Reference-System-VLRs">Coordinate Reference System VLRs</a><a id="Coordinate-Reference-System-VLRs-1"></a><a class="docs-heading-anchor-permalink" href="#Coordinate-Reference-System-VLRs" title="Permalink"></a></h2><p>The <em>LAS</em> 1.4 spec provides definitions for storing coordinate reference system details as <em>VLRs</em>. These are implemented as their own structs so they can be wrapped inside <code>LasVariableLengthRecord</code>s. These are split into two flavours: <em>WKT</em>, which uses the OpenGIS coordinate transformation service implementation specification <a href="https://www.opengeospatial.org/standards/ct">here</a>, and <em>GeoTiff</em>, which are included for legacy support for specs 1.1-1.3 (and are incompatible with <em>LAS</em> point formats 6-10).</p><h3 id="WKT"><a class="docs-heading-anchor" href="#WKT">WKT</a><a id="WKT-1"></a><a class="docs-heading-anchor-permalink" href="#WKT" title="Permalink"></a></h3><p><em>LASDatasets.jl</em> supports the <em>OGC Coordinate System WKT Record</em>, which is handled by the struct <code>OGC_WKT</code>. Currently we don&#39;t support <em>OGC Math Transform WKT</em>, however this could be supported in a future release.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LASDatasets.OGC_WKT-vlrs" href="#LASDatasets.OGC_WKT-vlrs"><code>LASDatasets.OGC_WKT</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct OGC_WKT</code></pre><p>A Coordinate System WKT record specified by the Open Geospatial Consortium (OGC) spec</p><ul><li><p><code>wkt_str::String</code>: The WKT formatted string for the coordinate system</p></li><li><p><code>nb::Int64</code>: Number of bytes in the WKT string</p></li><li><p><code>unit::Union{Missing, String}</code>: Units applied along the horizontal (XY) plane in this coordinate system</p></li><li><p><code>vert_unit::Union{Missing, String}</code>: Units applied along the vertical (Z) axis in this coordinate system. Note: this will not in general match the horizontal coordinate</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fugro-oss/LASDatasets.jl/blob/1328449f16cabfbb2c715365f439f5cc41632160/src/georef.jl#L165-L171">source</a></section></article><p>One benefit of using the <em>OGC WKT</em> is that you can specify what units of measurement are used for your point coordinates both in the <em>XY</em> plane and along the <em>Z</em> axis. When reading a <em>LAS</em> file, the system can detect if an <em>OGC WKT</em> is present and will, if requested by the user, convert the point coordinates to metres.</p><h3 id="GeoTiff"><a class="docs-heading-anchor" href="#GeoTiff">GeoTiff</a><a id="GeoTiff-1"></a><a class="docs-heading-anchor-permalink" href="#GeoTiff" title="Permalink"></a></h3><p><em>GeoTiff</em> <em>VLRs</em> are supported for legacy versions and also have their own <em>Julia</em> struct, which are given below. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LASDatasets.GeoKeys-vlrs" href="#LASDatasets.GeoKeys-vlrs"><code>LASDatasets.GeoKeys</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct GeoKeys</code></pre><p>Contains the TIFF keys that defines a coordinate system. A complete description can be found in the GeoTIFF format specification. </p><p>As per the spec:</p><ul><li><code>key_directory_version = 1</code> always</li><li><code>key_revision = 1</code> always</li><li><code>minor_revision = 0</code> always</li></ul><p>This may change in future LAS spec versions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fugro-oss/LASDatasets.jl/blob/1328449f16cabfbb2c715365f439f5cc41632160/src/georef.jl#L33-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LASDatasets.GeoDoubleParamsTag-vlrs" href="#LASDatasets.GeoDoubleParamsTag-vlrs"><code>LASDatasets.GeoDoubleParamsTag</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct GeoDoubleParamsTag</code></pre><p>A collection of values <code>double_params</code> that are referenced by tag sets in a <code>GeoKeys</code> record</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fugro-oss/LASDatasets.jl/blob/1328449f16cabfbb2c715365f439f5cc41632160/src/georef.jl#L118-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LASDatasets.GeoAsciiParamsTag-vlrs" href="#LASDatasets.GeoAsciiParamsTag-vlrs"><code>LASDatasets.GeoAsciiParamsTag</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct GeoAsciiParamsTag</code></pre><p>An array of ASCII data that contains many strings separated by null terminator characters in <code>ascii_params</code>. These are referenced by position from the data in a <code>GeoKeys</code> record</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fugro-oss/LASDatasets.jl/blob/1328449f16cabfbb2c715365f439f5cc41632160/src/georef.jl#L141-L146">source</a></section></article><h2 id="Other-Specification-Defined-VLRs"><a class="docs-heading-anchor" href="#Other-Specification-Defined-VLRs">Other Specification-Defined VLRs</a><a id="Other-Specification-Defined-VLRs-1"></a><a class="docs-heading-anchor-permalink" href="#Other-Specification-Defined-VLRs" title="Permalink"></a></h2><p>The <em>LAS</em> 1.4 spec also includes several other recognised <em>VLRs</em> that are automatically supported in <em>LASDatasets.jl</em>. </p><h3 id="Classification-Lookup"><a class="docs-heading-anchor" href="#Classification-Lookup">Classification Lookup</a><a id="Classification-Lookup-1"></a><a class="docs-heading-anchor-permalink" href="#Classification-Lookup" title="Permalink"></a></h3><p><em>LAS</em> 1.4 allows you to specify classification labels 0-255 for your point formats 6-10, where labels 0-22 having specific classes associated with them, classes 23-63 being reserved and classes 64-255 being user-definable. To give context to what your classes mean, you can add a Classification Lookup <em>VLR</em> into your <em>LAS</em> file, which is just a collection of classification labels paired with a string description. In <em>LASDatasets.jl</em>, this is handled as a <code>ClassificationLookup</code>:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LASDatasets.ClassificationLookup-vlrs" href="#LASDatasets.ClassificationLookup-vlrs"><code>LASDatasets.ClassificationLookup</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct ClassificationLookup</code></pre><p>A lookup record for classification labels. Each class has a short description telling you what it is.</p><ul><li><code>class_description_map::Dict{UInt8, String}</code>: Mapping of each class to a description</li></ul><hr/><pre><code class="language-julia hljs">ClassificationLookup(class_description_map)</code></pre><p>defined at <a href="https://github.com/fugro-oss/LASDatasets.jl/tree/1328449f16cabfbb2c715365f439f5cc41632160//src/registered_vlrs.jl#L14"><code>/home/runner/work/LASDatasets.jl/LASDatasets.jl/src/registered_vlrs.jl:14</code></a>.</p><pre><code class="language-julia hljs">ClassificationLookup(class_descriptions)</code></pre><p>defined at <a href="https://github.com/fugro-oss/LASDatasets.jl/tree/1328449f16cabfbb2c715365f439f5cc41632160//src/registered_vlrs.jl#L22"><code>/home/runner/work/LASDatasets.jl/LASDatasets.jl/src/registered_vlrs.jl:22</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fugro-oss/LASDatasets.jl/blob/1328449f16cabfbb2c715365f439f5cc41632160/src/registered_vlrs.jl#L1-L10">source</a></section></article><p>As an example, you can add a Classification Lookup <em>VLR</em> to your <em>LAS</em> file as follows:</p><pre><code class="language-julia hljs">pc = Table(position = rand(SVector{3, Float64}, 100), classification = rand((65, 100), 100))
# class 65 represents mailboxes, 100 represents street signs
lookup = ClassificationLookup(65 =&gt; &quot;Mailboxes&quot;, 100 =&gt; &quot;Street signs&quot;)
# make sure you set the right VLR IDs
vlrs = [LasVariableLengthRecord(&quot;LASF_Spec&quot;, 0, &quot;Classification Lookup&quot;, lookup)]
save_las(&quot;pc.las&quot;, pc; vlrs = vlrs)</code></pre><p>You can then read the <em>LAS</em> data and extract the classification lookup:</p><pre><code class="language-julia hljs">las = load_las(&quot;pc.las&quot;)
# look for the classification lookup VLR by checking for its user and record IDs
lookup_vlr = extract_vlr_type(get_vlrs(las), &quot;LASF_Spec&quot;, 0)
lookup = get_data(lookup_vlr)</code></pre><h3 id="Text-Area-Descriptions"><a class="docs-heading-anchor" href="#Text-Area-Descriptions">Text Area Descriptions</a><a id="Text-Area-Descriptions-1"></a><a class="docs-heading-anchor-permalink" href="#Text-Area-Descriptions" title="Permalink"></a></h3><p>You can add a description for your dataset using a <code>TextAreaDescription</code> data type</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LASDatasets.TextAreaDescription-vlrs" href="#LASDatasets.TextAreaDescription-vlrs"><code>LASDatasets.TextAreaDescription</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct TextAreaDescription</code></pre><p>A wrapper around a text area description, which is used for providing a textual description of the content of the LAS file</p><ul><li><code>txt::String</code>: Text describing the content of the LAS file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fugro-oss/LASDatasets.jl/blob/1328449f16cabfbb2c715365f439f5cc41632160/src/registered_vlrs.jl#L58-L64">source</a></section></article><p>Using the dataset <code>las</code> above, we can add a description as follows (and save/read it as we did above). Note you can also repeat the way the Classification Lookup was saved above too.</p><pre><code class="language-julia hljs">description = TextAreaDescription(&quot;This is an example LAS file and has no specific meaning&quot;)
add_vlr!(las, LasVariableLengthRecord(&quot;LASF_Spec&quot;, 3, &quot;Text Area Description&quot;, description))</code></pre><h3 id="Extra-Bytes"><a class="docs-heading-anchor" href="#Extra-Bytes">Extra Bytes</a><a id="Extra-Bytes-1"></a><a class="docs-heading-anchor-permalink" href="#Extra-Bytes" title="Permalink"></a></h3><p>Extra Bytes <em>VLRs</em> are a type of <em>VLR</em> that documents any user fields that have been added to point records in your <em>LAS</em> data. You can find an in-depth explanation of how to save/load user defined fields to your points <a href="../user_fields/">here</a>. </p><p>The Extra Bytes <em>VLRs</em> are represented by the <code>ExtraBytes</code> struct, and have a few methods to get some information from them. Note that currrently <em>LASDatasets.jl</em> only supports automatically detecting and writing the user field name, data type and description to the <em>VLR</em> based on input point data. Support for other fields such as the min/max range, scale/offset factors, etc. may become available in future releases. You can, however, still manually specify these if you choose.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LASDatasets.ExtraBytes-vlrs" href="#LASDatasets.ExtraBytes-vlrs"><code>LASDatasets.ExtraBytes</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct ExtraBytes{TData}</code></pre><p>Extra Bytes record that documents an extra field present for a point in a LAS file</p><ul><li><p><code>options::UInt8</code>: Specifies whether the min/max range, scale factor and offset for this field is set/meaningful and whether there is a special value to be interpreted as &quot;NO_DATA&quot;</p></li><li><p><code>name::String</code>: Name of the extra field</p></li><li><p><code>no_data::Any</code>: A value that&#39;s used if the &quot;NO_DATA&quot; flag is set in <code>options</code>. Use this if the point doesn&#39;t have data for this type</p></li><li><p><code>min_val::Any</code>: Minimum value for this field, zero if not using</p></li><li><p><code>max_val::Any</code>: Maximum value for this field, zero if not using</p></li><li><p><code>scale::Any</code>: Scale factor applied to this field, zero if not using</p></li><li><p><code>offset::Any</code>: Offset applied to this field, zero if not using</p></li><li><p><code>description::String</code>: Description of this extra field</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fugro-oss/LASDatasets.jl/blob/1328449f16cabfbb2c715365f439f5cc41632160/src/registered_vlrs.jl#L75-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LASDatasets.name-vlrs" href="#LASDatasets.name-vlrs"><code>LASDatasets.name</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">name(e::ExtraBytes) -&gt; String
</code></pre><p>Get the name of an additional user field that&#39;s documented by an extra bytes record <code>e</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fugro-oss/LASDatasets.jl/blob/1328449f16cabfbb2c715365f439f5cc41632160/src/registered_vlrs.jl#L129-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LASDatasets.data_type-vlrs" href="#LASDatasets.data_type-vlrs"><code>LASDatasets.data_type</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">data_type(_::ExtraBytes{TData}) -&gt; Any
</code></pre><p>Get the data type of an <code>ExtraBytes</code> record</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fugro-oss/LASDatasets.jl/blob/1328449f16cabfbb2c715365f439f5cc41632160/src/registered_vlrs.jl#L135-L139">source</a></section></article><h3 id="Waveform-Data"><a class="docs-heading-anchor" href="#Waveform-Data">Waveform Data</a><a id="Waveform-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Waveform-Data" title="Permalink"></a></h3><p>Currently <em>LASDatasets.jl</em> doesn&#39;t have fully extensive support for waveform data and flags, but this will likely be included in future releases. We do, however, support writing waveform packet descriptions as <em>VLRs</em> with the <code>WaveformPacketDescriptor</code>. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LASDatasets.WaveformPacketDescriptor-vlrs" href="#LASDatasets.WaveformPacketDescriptor-vlrs"><code>LASDatasets.WaveformPacketDescriptor</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct WaveformPacketDescriptor</code></pre><p>A Wave Packet Descriptor which contains information that describes the configuration of the waveform packets. Since systems may be configured differently at different times throughout a job, the LAS file supports 255 Waveform Packet Descriptors</p><ul><li><p><code>bits_per_sample::UInt8</code>: Number of bits per sample. 2 to 32 bits per sample are supported</p></li><li><p><code>compression_type::UInt8</code>: Indicates the compression algorithm used for the waveform packets associated with this descriptor. A value of 0 indicates no compression. Zero is the only value currently supported</p></li><li><p><code>num_samples::UInt32</code>: Number of samples associated to this packet type. This always corresponds to the decompressed waveform packet</p></li><li><p><code>temporal_sample_spacing::UInt32</code>: The temporal sample spacing in picoseconds. Example values might be 500, 1000, 2000, and so on, representing digitizer frequencies of 2 GHz, 1 GHz, and 500 MHz respectively.</p></li><li><p><code>digitizer_gain::Float64</code>: The digitizer gain used to convert the raw digitized value to an absolute digitizer voltage using the formula: 𝑉𝑂𝐿𝑇𝑆 = 𝑂𝐹𝐹𝑆𝐸𝑇 + 𝐺𝐴𝐼𝑁 * 𝑅𝑎𝑤<em>𝑊𝑎𝑣𝑒𝑓𝑜𝑟𝑚</em>𝐴𝑚𝑝𝑙𝑖𝑡𝑢𝑑𝑒</p></li></ul><ul><li><code>digitizer_offset::Float64</code>: The digitizer offset used to convert the raw digitized value to an absolute digitizer using formula above</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fugro-oss/LASDatasets.jl/blob/1328449f16cabfbb2c715365f439f5cc41632160/src/registered_vlrs.jl#L277-L285">source</a></section></article><h2 id="Custom-VLRs"><a class="docs-heading-anchor" href="#Custom-VLRs">Custom VLRs</a><a id="Custom-VLRs-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-VLRs" title="Permalink"></a></h2><p>As well as the <em>VLR</em> record types mentioned above, you can write your own <em>Julia</em>-native structs as <em>VLRs</em> quite easily using <em>LASDatasets.jl</em>. By default, <em>LASDatasets.jl</em> will just read the raw bytes for your <em>VLRs</em>, so there are a couple of steps to enable correct <em>VLR</em> parsing.</p><p>Firstly, you need to define methods to read and write your data type. For writing, this just means overloading <code>Base.write</code> for your type.</p><p>Reading works a little differently. Since each <em>VLR</em> has a &quot;record length after header&quot;, the system knows how many bytes each record needs. If your data type has statically-sized fields (like numbers or static arrays), you already know how many bytes you&#39;re reading (and this needs to be reflected in a <code>Base.sizeof</code> method for your type). You&#39;ll need to overload the function <code>LASDatasets.read_vlr_data</code> for your data type, which accepts the number of bytes to read alongside your type. This allows you to read non-static types for fields as well as static ones.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LASDatasets.read_vlr_data-vlrs" href="#LASDatasets.read_vlr_data-vlrs"><code>LASDatasets.read_vlr_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_vlr_data(
    io::IO,
    _::Type{TData},
    nb::Integer
) -&gt; ExtraBytesCollection
</code></pre><p>Read data of type <code>TData</code> that belongs to a VLR by readig <code>nb</code> bytes from an <code>io</code>.  By default this will call <code>Base.read</code>, but for more specific read methods this will need to be overloaded for your type</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fugro-oss/LASDatasets.jl/blob/1328449f16cabfbb2c715365f439f5cc41632160/src/vlrs.jl#L196-L201">source</a></section></article><p>As an example, you could have</p><pre><code class="language-julia hljs">struct MyType
    name::String

    value::Float64
end

# important to know how many bytes your record will take up
Base.sizeof(x::MyType) = Base.sizeof(x.name) + 8

function LASDatasets.read_vlr_data(io::IO, ::Type{MyType}, nb::Integer)
    @assert nb ≥ 8 &quot;Not enough bytes to read data of type MyType!&quot;
    # the name will depend on how many bytes we&#39;ve been told to read
    name = LASDatasets.readstring(io, nb - 8)
    value = read(io, Float64)
    return MyType(name, value)
end

function Base.write(io::IO, x::MyType)
    write(io, x.name)
    write(io, x.value)
end</code></pre><p>Finally, the system needs some way to know what data type to read for the <em>VLR</em> for a specific user ID and record ID, otherwise it will just read the raw bytes back to you. To register the &quot;official&quot; IDs to use, you can use the macro <code>@register_vlr_type</code>:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LASDatasets.@register_vlr_type-vlrs" href="#LASDatasets.@register_vlr_type-vlrs"><code>LASDatasets.@register_vlr_type</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Register a new VLR data type <code>type</code> by associating it with an official <code>user_id</code> and set of <code>record_ids</code> </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fugro-oss/LASDatasets.jl/blob/1328449f16cabfbb2c715365f439f5cc41632160/src/vlrs.jl#L162-L166">source</a></section></article><p>So in our example, we can tell the system that records containing data of type <code>MyType</code> will always have a user ID &quot;My Custom Records&quot; and record IDs 1-100:</p><pre><code class="language-julia hljs">@register_vlr_type MyType &quot;My Custom Records&quot; collect(1:100)</code></pre><p>And now we can save our <code>MyType</code> <em>VLRs</em> into a <em>LAS</em> file in the same way as we did above for the register <em>VLR</em> types. Note that you can use the function <code>extract_vlr_type</code> on your collection of <em>VLRs</em> to pull out the <em>VLR</em> with a specific user ID and record ID. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LASDatasets.extract_vlr_type-vlrs" href="#LASDatasets.extract_vlr_type-vlrs"><code>LASDatasets.extract_vlr_type</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">extract_vlr_type(
    vlrs::Vector{&lt;:LasVariableLengthRecord},
    user_id::String,
    record_id::Integer
) -&gt; Union{Nothing, LasVariableLengthRecord}
</code></pre><p>Extract the VLR with a <code>user_id</code> and <code>record_id</code> from a collection of VLRs, <code>vlrs</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fugro-oss/LASDatasets.jl/blob/1328449f16cabfbb2c715365f439f5cc41632160/src/vlrs.jl#L259-L263">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../points/">« Points</a><a class="docs-footer-nextpage" href="../user_fields/">User Fields »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 31 January 2025 00:18">Friday 31 January 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
